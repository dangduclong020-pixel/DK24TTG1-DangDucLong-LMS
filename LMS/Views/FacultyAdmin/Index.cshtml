@{
    ViewData["Title"] = $"Dashboard {ViewBag.FacultyName}";
    Layout = "~/Views/Shared/_FacultyLayout.cshtml";
}

<div class="top-header">
    <div class="welcome-text">
        <h1>Xin ch√†o, @(ViewBag.UserName ?? "Gi√°o v·ª• Khoa") üëã</h1>
        <p>Qu·∫£n l√Ω ho·∫°t ƒë·ªông ƒë√†o t·∫°o @(ViewBag.FacultyName) - H·ªçc k·ª≥ I - NƒÉm h·ªçc 2024-2025</p>
    </div>
    <div class="current-term">
        <i class="fa-regular fa-calendar"></i>
        Tu·∫ßn 08 - H·ªçc k·ª≥ 1 (2024)
    </div>
</div>

<!-- Alert Messages -->
@if (TempData["SuccessMessage"] != null)
{
    <div class="alert alert-success alert-dismissible fade show" role="alert">
        <i class="fas fa-check-circle"></i> @TempData["SuccessMessage"]
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
}
@if (TempData["ErrorMessage"] != null)
{
    <div class="alert alert-danger alert-dismissible fade show" role="alert">
        <i class="fas fa-exclamation-triangle"></i> @TempData["ErrorMessage"]
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
}

<div class="stats-grid">
    <div class="stat-card">
        <h4>H·ªçc ph·∫ßn khoa qu·∫£n l√Ω</h4>
        <div class="stat-value">@ViewBag.TotalCourses</div>
        <div class="stat-desc"><i class="fa-solid fa-book-open"></i> H·ªçc ph·∫ßn ƒëang ho·∫°t ƒë·ªông</div>
    </div>
    <div class="stat-card" style="border-left-color: #faad14;">
        <h4>Sinh vi√™n thu·ªôc khoa</h4>
        <div class="stat-value">@ViewBag.TotalStudents</div>
        <div class="stat-desc" style="color:#8c8c8c;">ƒêang h·ªçc t·∫°i @ViewBag.FacultyName</div>
    </div>
    <div class="stat-card" style="border-left-color: #1890ff;">
        <h4>Gi·∫£ng vi√™n c∆° h·ªØu</h4>
        <div class="stat-value">@ViewBag.TotalTeachers</div>
        <div class="stat-desc" style="color:#1890ff;">Thu·ªôc @ViewBag.FacultyName</div>
    </div>
    <div class="stat-card" style="border-left-color: #ff4d4f;">
        <h4>B·ªô m√¥n tr·ª±c thu·ªôc</h4>
        <div class="stat-value">@ViewBag.TotalDepartments</div>
        <div class="stat-desc" style="color:#ff4d4f;">B·ªô m√¥n ƒëang ho·∫°t ƒë·ªông</div>
    </div>
</div>

<div class="row">
    <div class="col-xl-8 mb-4">
        <div class="section-card">
            <div class="card-header">
                <div class="card-title">Ti·∫øn ƒë·ªô l·ªõp h·ªçc ph·∫ßn (H√¥m nay)</div>
                <a asp-action="CourseManagement" style="font-size:13px; color:var(--primary-color); text-decoration:none;">Xem t·∫•t c·∫£</a>
            </div>
            <div class="table-responsive">
                <table>
                    <thead>
                        <tr>
                            <th>M√£ LHP</th>
                            <th>T√™n h·ªçc ph·∫ßn</th>
                            <th>Gi·∫£ng vi√™n</th>
                            <th>Ph√≤ng</th>
                            <th>Ca h·ªçc</th>
                            <th>Tr·∫°ng th√°i</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (ViewBag.FacultyClasses != null && ((List<LMS.Models.Class>)ViewBag.FacultyClasses).Any())
                        {
                            @foreach (var classItem in (List<LMS.Models.Class>)ViewBag.FacultyClasses)
                            {
                                <tr>
                                    <td><b>@classItem.Course?.Code</b></td>
                                    <td>@classItem.Course?.Name</td>
                                    <td>@(classItem.Instructor?.FullName ?? "Ch∆∞a ph√¢n c√¥ng")</td>
                                    <td>@(classItem.Schedules?.FirstOrDefault()?.Room ?? "--")</td>
                                    <td>@(classItem.Schedules?.FirstOrDefault()?.DayOfWeek ?? "Ch∆∞a x·∫øp l·ªãch")</td>
                                    <td>
                                        @{
                                            var status = classItem.IsActive == true ? "ƒêang ho·∫°t ƒë·ªông" : "T·∫°m d·ª´ng";
                                            var statusClass = classItem.IsActive == true ? "bg-progress" : "bg-closed";
                                        }
                                        <span class="status-badge @statusClass">@status</span>
                                    </td>
                                </tr>
                            }
                        }
                        else
                        {
                            <tr>
                                <td colspan="6" class="text-center" style="padding: 20px; color: #8c8c8c;">
                                    <i class="fa-solid fa-inbox"></i><br>
                                    Ch∆∞a c√≥ l·ªõp h·ªçc ph·∫ßn n√†o ƒë∆∞·ª£c t·∫°o cho khoa n√†y
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="col-xl-4 mb-4">
        <div class="section-card">
            <div class="card-header">
                <div class="card-title">C·∫ßn x·ª≠ l√Ω g·∫•p</div>
            </div>
            <div class="urgent-tasks">
                <div class="task-item">
                    <div class="task-icon warning">
                        <i class="fa-solid fa-chalkboard-teacher"></i>
                    </div>
                    <div class="task-content">
                        <h5>L·ªõp h·ªçc c·∫ßn ph√¢n c√¥ng GV</h5>
                        <p>C√≥ @ViewBag.TotalCourses h·ªçc ph·∫ßn thu·ªôc @ViewBag.FacultyName c·∫ßn b·ªë tr√≠ gi·∫£ng d·∫°y.</p>
                        <a href="@Url.Action("TeacherManagement", "FacultyAdmin")" class="btn btn-sm btn-outline-warning mt-2">Ph√¢n c√¥ng ngay</a>
                    </div>
                </div>

                <div class="task-item">
                    <div class="task-icon info">
                        <i class="fa-solid fa-users"></i>
                    </div>
                    <div class="task-content">
                        <h5>Qu·∫£n l√Ω sinh vi√™n khoa</h5>
                        <p>@ViewBag.TotalStudents sinh vi√™n ƒëang theo h·ªçc t·∫°i @ViewBag.FacultyName.</p>
                        <a href="@Url.Action("StudentManagement", "FacultyAdmin")" class="btn btn-sm btn-outline-info mt-2">Xem danh s√°ch</a>
                    </div>
                </div>

                <div class="task-item">
                    <div class="task-icon success">
                        <i class="fa-solid fa-user-tie"></i>
                    </div>
                    <div class="task-content">
                        <h5>ƒê·ªôi ng≈© gi·∫£ng vi√™n</h5>
                        <p>@ViewBag.TotalTeachers gi·∫£ng vi√™n ƒëang c√¥ng t√°c t·∫°i @ViewBag.FacultyName.</p>
                        <a href="@Url.Action("TeacherManagement", "FacultyAdmin")" class="btn btn-sm btn-outline-success mt-2">Qu·∫£n l√Ω GV</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .urgent-tasks {
        display: flex;
        flex-direction: column;
        gap: 20px;
    }

    .task-item {
        display: flex;
        gap: 12px;
        padding-bottom: 15px;
        border-bottom: 1px solid #f0f0f0;
    }

    .task-item:last-child {
        border-bottom: none;
        padding-bottom: 0;
    }

    .task-icon {
        width: 36px;
        height: 36px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
        font-size: 14px;
    }

    .task-icon.urgent {
        background: #fff1f0;
        color: #ff4d4f;
    }

    .task-icon.warning {
        background: #fff7e6;
        color: #faad14;
    }

    .task-icon.info {
        background: #e6f7ff;
        color: #1890ff;
    }

    .task-icon.success {
        background: #f6ffed;
        color: #52c41a;
    }

    .task-content h5 {
        font-size: 13px;
        margin-bottom: 5px;
        font-weight: 600;
    }

    .task-content p {
        font-size: 12px;
        color: #8c8c8c;
        margin-bottom: 0;
    }
</style>

